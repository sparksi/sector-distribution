<?php

use Drupal\user\Entity\User;

/**
 * @file
 */

/**
 * Implements hook_form_alter().
 *
 * Improve page node status checkbox by changing the label
 * from "Publishing status" to "Publish" and removing the description.
 *
 * This should bring it in line with all other content types.
 */
function sector_utils_form_alter(&$form, $form_state, $form_id) {
  switch ($form_id) {
    case 'node_page_form':
    case 'node_page_edit_form':
      $element = &$form['status']['widget']['value'];
      $element['#title'] = t('Published');
      $element['#description'] = t('');
      break;
  }
}

/**
 * Implements hook_contextual_links_view_alter().
 *
 * Hides the configure block link based if the user doesn't have the right
 * permission.
 */
function sector_utils_contextual_links_view_alter(&$element, $items) {
  $user = \Drupal::currentUser();

  if(isset($element['#links']['block-configure'])) {
    if (!$user->hasPermission('configure blocks from contextual links')) {
      unset($element['#links']['block-configure']);
    }
  }
}
